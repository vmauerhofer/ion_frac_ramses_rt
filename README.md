# Ionization Fractions for RAMSES-RT

This repository provides a Python tool to compute ionization fractions of metal species from RAMSES-RT simulation snapshots. It builds chemical reaction networks compatible with [KROME](https://bitbucket.org/tgrassi/krome/wiki/Home), based on recombination and ionization rates, and is meant to be integrated into a broader post-processing pipeline.

## Features

* Supports **Radiative Recombination** and **Dielectronic Recombination** using atomic data from Badnell
* Includes **Collisional Ionization** rates from Voronov
* Automatically builds KROME-compatible chemical networks
* Designed for use with RAMSES-RT outputs, but flexible for other applications
* Generates Fortran-style rate expressions compatible with chemical solvers

## Repository Structure

```
ion_frac_ramses_rt/
├── chemical_network_builder.py      # Main class to generate rates and build the network
├── krome_files_to_change/           # Files to patch into KROME source directory
├── rates/                           # Atomic and collisional data files
│   ├── Radiative_rec/
│   ├── Dielectronic_rec/
│   └── Collisions/
├── test_network.txt                 # Example output network (optional)
├── test.ipynb                       # Notebook for interactive testing (optional)
└── README.md
```

## Quick Start

### 1. Clone this repository

```bash
git clone https://github.com/<your-username>/ion_frac_ramses_rt.git
cd ion_frac_ramses_rt
```

### 2. Patch KROME (if needed)

Some small modifications are required in KROME's source code to support the networks generated by this tool.

Copy the provided patch files:

```bash
cp ./krome_files_to_change/* /path/to/krome/src/
```

> These changes are minimal and documented. This step is required only if using the output with KROME.

### 3. Use the Tool in Python

```python
from chemical_network_builder import ChemicalNetworkBuilder

# Define the species of interest and max ionization states
elements = {"C": 4, "Si": 4}

# Create a builder instance
builder = ChemicalNetworkBuilder()

# Generate the network
builder.build_krome_network(elements, output_path="test_network.txt")
```

This will generate a network file containing the relevant reactions for KROME.

## Requirements

* Python ≥ 3.7
* `pandas`, `numpy`

Install them with:

```bash
pip install pandas numpy
```

## Notes

* H and He dummy reactions (with rate 0) are added for KROME compatibility
* KROME itself is **not** included and must be downloaded separately
* This repository is only one part of a larger pipeline that computes ionization states from RAMSES-RT outputs
* The included atomic rate data comes from:

  * M. Badnell (recombination): [http://amdpp.phys.strath.ac.uk/tamoc/](http://amdpp.phys.strath.ac.uk/tamoc/)
  * Voronov 1997 (collisional ionization)

## License

MIT License

## Acknowledgments

* Built with reference to the KROME project and atomic data from the scientific literature.
* Development in the context of astrophysical simulations using RAMSES-RT.
